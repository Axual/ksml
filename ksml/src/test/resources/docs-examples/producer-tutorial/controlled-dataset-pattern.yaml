functions:
  load_from_list:
    type: generator
    globalCode: |
      dataset = ["item1", "item2", "item3", "item4", "item5"]
      index = 0
      all_data_loaded = False
    code: |
      global index, all_data_loaded, dataset
      if index >= len(dataset):
        all_data_loaded = True
        return (None, None)
      item = dataset[index]
      index += 1
      return (f"key_{index}", {"data": item})
    resultType: (string, json)

producers:
  dataset_loader:
    generator: load_from_list
    until: all_data_loaded  # Stop when list is exhausted
    interval: 100
    to:
      topic: my_topic
      keyType: string
      valueType: json
