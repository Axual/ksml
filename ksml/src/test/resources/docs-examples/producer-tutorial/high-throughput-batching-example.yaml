functions:
  batch_generator:
    type: generator
    globalCode: |
      counter = 0
    code: |
      global counter
      messages = []
      for i in range(100):
        key = f"key{counter}"
        value = {"id": counter, "data": f"message_{counter}"}
        messages.append((key, value))
        counter += 1
      return messages
    resultType: list(tuple(string, json))

producers:
  high_volume_producer:
    generator: batch_generator  # Should return list of tuples
    interval: 100  # 100ms between batches
    batchSize: 100  # 100 messages per batch
    count: 10000  # Total 10,000 messages = 100 batches
    to: high_volume_topic
