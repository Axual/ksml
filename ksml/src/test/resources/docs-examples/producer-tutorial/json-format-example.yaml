functions:
  generate_json:
    type: generator
    globalCode: |
      import random
      counter = 0
    code: |
      global counter
      key = f"sensor{counter}"
      counter = (counter + 1) % 10
      value = {
        "id": counter,
        "temperature": random.randint(0, 100),
        "humidity": random.randint(0, 100)
      }
      return (key, value)
    resultType: (string, json)

producers:
  json_producer:
    generator: generate_json
    interval: 2s
    to:
      topic: sensor_data_json
      keyType: string
      valueType: json
