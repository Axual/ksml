functions:
  generate_amount:
    type: generator
    globalCode: |
      import random
      customer_counter = 0
      customers = ["CUST001", "CUST002", "CUST003", "CUST004", "CUST005"]
    code: |
      global customer_counter, customers
      
      # Cycle through customers
      customer = customers[customer_counter % len(customers)]
      customer_counter += 1
      
      # Generate amount in cents as long
      amount = random.randint(1000, 50000)  # $10 to $500
      
      key = customer
      value = amount
    expression: (key, value)
    resultType: (string, long)

producers:
  amount_producer:
    generator: generate_amount
    interval: 1s
    to:
      topic: payment_amounts
      keyType: string
      valueType: long