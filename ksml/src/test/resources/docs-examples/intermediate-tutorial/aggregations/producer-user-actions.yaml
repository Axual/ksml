functions:
  generate_user_action:
    type: generator
    globalCode: |
      import random
      import time
      user_counter = 0
      users = ["alice", "bob", "charlie", "david", "eve", "frank", "grace", "henry"]
      actions = ["login", "view", "click", "purchase", "logout", "search", "share", "comment"]
    code: |
      global user_counter, users, actions
      
      # Cycle through users
      user = users[user_counter % len(users)]
      user_counter += 1
      
      # Generate action event
      value = {
        "user_id": user,
        "action": random.choice(actions),
        "timestamp": int(time.time() * 1000)
      }
      
      # Use user_id as key
      key = user
    expression: (key, value)
    resultType: (string, json)

producers:
  user_action_producer:
    generator: generate_user_action
    interval: 1s
    to:
      topic: user_actions
      keyType: string
      valueType: json