functions:
  generate_transaction:
    type: generator
    globalCode: |
      import random
      account_counter = 0
      accounts = ["ACC001", "ACC002", "ACC003", "ACC004", "ACC005"]
    code: |
      global account_counter, accounts
      
      # Cycle through accounts
      account = accounts[account_counter % len(accounts)]
      account_counter += 1
      
      # Generate transaction amount (in cents)
      amount = random.randint(100, 50000)
      
      key = account
      value = amount
    expression: (key, value)
    resultType: (string, long)

producers:
  transaction_producer:
    generator: generate_transaction
    interval: 1s
    to:
      topic: financial_transactions
      keyType: string
      valueType: long