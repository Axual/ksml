# Simple demonstration of 'any' type processing

streams:
  any_input:
    topic: any_data
    keyType: string
    valueType: json

  any_output:
    topic: processed_any_data
    keyType: string
    valueType: json

functions:
  # Helper function with 'any' parameter type
  process_data:
    type: generic
    parameters:
      - name: data
        type: any  # Accepts any type
    code: |
      return {
        "processed_data": data,
        "status": "processed"
      }
    resultType: json

  # Function that uses the helper
  process_any:
    type: valueTransformer
    code: |
      # Use helper function that accepts 'any' type
      return process_data(value)

    resultType: json

pipelines:
  process_data:
    from: any_input
    via:
      - type: transformValue
        mapper: process_any
      - type: peek
        forEach:
          code: |
            log.info("Processed any type: {} = {}",
                     value.get("input_type"), value.get("input_value"))
    to: any_output