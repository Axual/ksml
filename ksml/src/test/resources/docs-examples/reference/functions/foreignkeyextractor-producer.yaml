functions:
  generate_orders:
    type: generator
    globalCode: |
      import random, time
      order_counter = 1
    code: |
      global order_counter
      oid = f"ord_{order_counter:03d}"
      order_counter += 1
      return oid, {
        "order_id": oid,
        "customer_id": random.choice(["c001", "c002", "c003"]),
        "product": random.choice(["laptop", "phone"]),
        "amount": random.randint(100, 1000),
        "timestamp": int(time.time() * 1000)
      }
    resultType: (string, json)
    
  generate_customers:
    type: generator
    globalCode: |
      import time, random
      custs = [
        {"id": "c001", "name": "Alice", "tier": "gold"},
        {"id": "c002", "name": "Bob", "tier": "silver"},  
        {"id": "c003", "name": "Charlie", "tier": "bronze"}
      ]
    code: |
      global custs
      c = random.choice(custs)
      return c["id"], {
        "customer_id": c["id"],
        "name": c["name"],
        "tier": c["tier"],
        "created_at": int(time.time() * 1000)
      }
    resultType: (string, json)

producers:
  order_producer:
    generator: generate_orders
    interval: 3s
    to:
      topic: orders
      keyType: string
      valueType: json
      
  customer_producer:
    generator: generate_customers
    interval: 5s  # Create customers periodically
    to:
      topic: customers
      keyType: string
      valueType: json