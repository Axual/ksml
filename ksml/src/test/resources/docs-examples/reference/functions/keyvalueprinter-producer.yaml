functions:
  generate_sales_data:
    type: generator
    globalCode: |
      import random
      counter = 1
      products = ["laptop", "mouse", "keyboard", "monitor", "webcam"]
      customers = ["alice", "bob", "charlie", "diana"]
      
    code: |
      global counter, products, customers
      
      sale_id = f"sale_{counter:03d}"
      counter += 1
      
      sale_data = {
        "sale_id": sale_id,
        "product": random.choice(products),
        "customer": random.choice(customers),
        "amount": round(random.uniform(19.99, 299.99), 2),
        "quantity": random.randint(1, 3),
        "region": random.choice(["north", "south", "east", "west"])
      }
      
    expression: (sale_id, sale_data)
    resultType: (string, json)

producers:
  sales_producer:
    generator: generate_sales_data
    interval: 3s
    to:
      topic: sales_data
      keyType: string
      valueType: json