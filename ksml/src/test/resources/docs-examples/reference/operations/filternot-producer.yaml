functions:
  generate_product:
    type: generator
    globalCode: |
      import random
      counter = 0
    code: |
      global counter
      counter += 1
      pid = f"p{counter:03d}"
      return pid, {
        "product_id": pid,
        "name": random.choice(["laptop", "phone", "tablet"]),
        "status": random.choice(["active", "inactive", "pending"]),
        "price": round(random.uniform(50, 1500), 2)
      }
    resultType: (string, json)

producers:
  product_producer:
    generator: generate_product
    interval: 2s
    to:
      topic: product_stream
      keyType: string
      valueType: json