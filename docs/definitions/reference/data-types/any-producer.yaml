# Simple demonstration of 'any' and '?' types in KSML

streams:
  any_data:
    topic: any_data
    keyType: string
    valueType: json

functions:
  generate_data:
    type: generator
    code: |
      import random

      # Generate different JSON-compatible data structures
      if random.choice([True, False]):
        data = {"type": "text", "value": "hello world"}
      else:
        data = {"type": "number", "value": 42}

      return ("key1", data)

    resultType: (string, json)

  # Function with '?' parameter type
  describe_data:
    type: generic
    parameters:
      - name: value
        type: "?"  # Accepts any type
    code: |
      return "processed"

    resultType: string

producers:
  test_producer:
    generator: generate_data
    interval: 2s
    to: any_data