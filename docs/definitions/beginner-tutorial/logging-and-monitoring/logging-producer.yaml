# Producer for logging and monitoring tutorial
# Generates simple messages with different importance levels for logging demonstration

functions:
  generate_log_message:
    type: generator
    globalCode: |
      import random
      import time
      log_counter = 0
    code: |
      global log_counter
      
      levels = ["INFO", "WARN", "ERROR", "DEBUG"]
      messages = [
        "System startup completed",
        "Database connection established", 
        "User authentication failed",
        "Cache refresh initiated",
        "Memory usage high",
        "Backup process completed"
      ]
      
      key = "log-" + str(log_counter)
      log_counter += 1
      
      value = {
        "level": random.choice(levels),
        "message": random.choice(messages),
        "timestamp": time.time(),
        "importance": random.randint(1, 10),
        "component": random.choice(["auth", "db", "cache", "backup"])
      }
    expression: (key, value)
    resultType: (string, json)

producers:
  log_message_producer:
    generator: generate_log_message
    interval: 2s
    to:
      topic: ksml_logging_input
      keyType: string
      valueType: json